# Ozon Route 256 ‚Äî Kafka Homework

## –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ
–ù–∞—à –º–∞–ª–µ–Ω—å–∫–∏–π —Å—Ç–∞—Ä—Ç–∞–ø –ö–∏—Å–ª–æ—Ä–æ–¥.–†—É –ø–µ—Ä–µ—Ä–æ—Å –≤ —Å–µ—Ä—å–µ–∑–Ω—ã–π –±–∏–∑–Ω–µ—Å, –∏ –Ω–∞–º –Ω—É–∂–Ω–æ –Ω–∞—É—á–∏—Ç—å—Å—è –≤ —É—á—ë—Ç –ø—Ä–æ–¥–∞–Ω–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞, –∞ —Ç–∞–∫–∂–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –≤ –∞–Ω–∞–ª–∏—Ç–∏–∫—É –ø—Ä–æ–¥–∞–≤–∞–µ–º–æ–≥–æ —Ç–æ–≤–∞—Ä–∞

–í –ø—Ä–æ–¥–µ —É –Ω–∞—Å –µ—Å—Ç—å —Å–µ—Ä–≤–∏—Å –∑–∞–∫–∞–∑–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ —Ç–æ–ø–∏–∫ –ö–∞—Ñ–∫–∏ —Å–æ–±—ã—Ç–∏–µ –æ–± —ç—Ç–æ–º (–≤ —Ä–∞–º–∫–∞—Ö –î–ó –µ–≥–æ —Ä–æ–ª—å –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–Ω—Å–æ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ—â–∞–¥–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ —ç—Ç–æ—Ç —Ç–æ–ø–∏–∫).

–í–æ—Ç —Ñ–æ—Ä–º–∞—Ç —ç—Ç–æ–≥–æ —Å–æ–±—ã—Ç–∏—è:
```json
{
    "moment": "timestamp",
    "order_id": "long",
    "user_id": "long",
    "warehouse_id": "long",
    "positions": {
        "item_id": "long",
        "quantity": "int",
        "price": {
            "currency": "RUR|KZT",
            "units": "long",
            "nanos": "int"
        }
    },
    "status": "Created|Canceled|Delivered"
}
```

–ü–æ—è—Å–Ω–µ–Ω–∏—è –∫ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—É:
* –ü–µ—Ä–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ –ø–æ –∑–∞–∫–∞–∑—É –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç created
* –í—Ç–æ—Ä–æ–µ —Å–æ–±—ã—Ç–∏–µ ‚Äî –≤—Å–µ–≥–¥–∞ canceled –∏–ª–∏ delivered. –ù–æ –≤—Ç–æ—Ä–æ–≥–æ –º–æ–∂–µ—Ç –∏ –Ω–µ –±—ã—Ç—å
* –û–±—ä–µ–∫—Ç price –ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Ç–∏–ø google.type.money.
 * * currency - –≤–∞–ª—é—Ç–∞,
 * * units - —Ü–µ–ª–∞—è —á–∞—Å—Ç—å
 * * nanos - –¥—Ä–æ–±–Ω–∞—è —á–∞—Å—Ç—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 0..1, —É–º–Ω–æ–∂–µ–Ω–Ω–∞—è –Ω–∞ 1,000,000,000.
 * * –ü—Ä–∏–º–µ—Ä: —Ü–µ–Ω–∞ –≤ 5316 —Ä—É–±–ª—è 78 –∫–æ–ø–µ–µ–∫ –±—É–¥–µ—Ç –æ—Ç—Ä–∞–∂–µ–Ω–∞ –∫–∞–∫ currency="RUB", units=5316, nanos = 780_000_000

### –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ ‚Ññ1 ‚Äî —Å–µ—Ä–≤–∏—Å
–ù–∞–ø–∏—Å–∞—Ç—å —Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —á–∏—Ç–∞—Ç—å —ç—Ç–æ—Ç —Ç–æ–ø–∏–∫ –∏ —Å—á–∏—Ç–∞—Ç—å –≤–∏—Ç—Ä–∏–Ω—É –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—É—é –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤ –≤–∏–¥–µ —Ç–∞–±–ª–∏—Ü—ã:
* –£—á–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ ‚Äî –ø–æ –∫–∞–∂–¥–æ–º—É item_id: —Å–∫–æ–ª—å–∫–æ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ (created), —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–¥–∞–Ω–æ (–ø–µ—Ä–µ—Ö–æ–¥ created ‚Üí delivered), —Å–∫–æ–ª—å–∫–æ –æ—Ç–º–µ–Ω–µ–Ω–æ (created ‚Üí cancelled). –¢–∞–∫–∂–µ —Å—Ç–æ–∏—Ç —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.
* üíé –£—á—ë—Ç –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –∫ —É–ø–ª–∞—Ç–µ –∫–∞–∂–¥–æ–º—É –ø—Ä–æ–¥–∞–≤—Ü—É. item_id –≤—Å–µ–≥–¥ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 12 —Ü–∏—Ñ—Ä. –ü–µ—Ä–≤—ã–µ 6 —Ü–∏—Ñ—Ä —É item_id ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–¥–∞–≤—Ü–∞ –¥–∞–Ω–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞, —Å–ª–µ–¥—É—é—â–∏–µ 6 —Ü–∏—Ñ—Ä ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–æ–≤–∞—Ä–∞ —É –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–¥–∞–≤—Ü–∞(—Ç–æ –µ—Å—Ç—å `213176086538` –∏ `213176768102` ‚Äî —Ç–æ–≤–∞—Ä—ã –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–¥–∞–≤—Ü–∞, –∞ `213176086538` –∏ `133676086538` ‚Äî —Ä–∞–∑–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–¥–∞–≤—Ü–æ–≤, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–æ—Å—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 6 —Ü–∏—Ñ—Ä). –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–¥–∞–≤—Ü–∞ –Ω–µ –º–æ–∂–µ—Ç –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å 0 (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–¥–∞–≤—Ü–∞ `100000`). –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ–¥–∞–∂–∏ (delivered) –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –≤ —Ä–∞–∑–Ω–æ–π –≤–∞–ª—é—Ç–µ –∏ –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ.
* üíé –ó–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–æ–∫ –ø–æ–¥—Å—á–µ—Ç–∞ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ 2+ –ø–∞—Ä—Ç–∏—Ü–∏–π –∏ 2+ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ —Å–µ—Ä–≤–∏—Å–∞. –ß—Ç–æ –∑–∞ –æ—à–∏–±–∫–∞ –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å —Å–ª–µ–¥—É–µ—Ç –¥–æ–≥–∞–¥–∞—Ç—å—Å—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ.

### –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ ‚Ññ2 ‚Äî —Ä–µ–≤—å—é
–ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä–µ–≤—å—é –∫–æ–¥–∞.
1) –ü–æ—Ä–µ–≤—å—é–π—Ç–µ —Ä–µ—à–µ–Ω–∏–µ –¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏ –º–∏–Ω–∏–º—É–º 1 —Å–æ–∫—É—Ä—Å–Ω–∏–∫–∞, —É –∫–æ—Ç–æ—Ä–æ–≥–æ —Ç–æ—Ç –∂–µ —Ç—å—é—Ç–æ—Ä, —á—Ç–æ –∏ —É –≤–∞—Å.
2) –ö—Ä–∏—Ç–µ—Ä–∏–π –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏ ‚Äî –Ω–∞–ª–∏—á–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏ approve –æ—Ç –≤–∞—Å –Ω–∞ —á—É–∂–æ–º merge request (¬´–∞–ø—Ä—É–≤ –Ω–µ –≥–ª—è–¥—è¬ª –º—ã —Å –≤–∞–º–∏ —Ä–µ—à–∏—Ç–µ–ª—å–Ω–æ –æ—Å—É–∂–¥–∞–µ–º).
3) –î–æ–ø—É—Å–∫–∞—é—Ç—Å—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (¬´–∫–ª–∞—Å—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–¥–µ—Å—å –≤—Å—Ç–∞–≤–∫–∏ –Ω–∞ –∞—Å—Å–µ–º–±–ª–µ—Ä–µ!¬ª), –≤–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ (¬´–ê –ø–æ—á–µ–º—É –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º async void?¬ª), –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ (¬´–æ—á–µ–ø—è—Ç–∫–∞ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ –∫–ª–∞—Å—Å–∞¬ª), –∞ —Ç–∞–∫–∂–µ –∑–Ω–∞—á–∏–º—ã–µ (¬´–ó–¥–µ—Å—å –ª—É—á—à–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ null reference exception¬ª, ¬´–ù–µ —Å—Ç–æ–∏—Ç –æ—Å—Ç–∞–≤–ª—è—Ç—å –≤ –∫–æ–¥–µ –º–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞, –ø–æ—ç—Ç–æ–º—É 49.5 —Å–∞–Ω—Ç–∏–º–µ—Ç—Ä–æ–≤ –ª—É—á—à–µ –≤—ã–Ω–µ—Å—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É¬ª)

–ü—Ä–∞–≤–∏–ª–∞ —Ä–µ–≤—å—é (–±–∞–∑–æ–≤—ã–µ).
1) –ë—É–¥—å—Ç–µ –≤–µ–∂–ª–∏–≤—ã. –û–±—Å—É–∂–¥–∞–π—Ç–µ –∫–æ–¥, –∞ –Ω–µ –∞–≤—Ç–æ—Ä–∞ –∫–æ–¥–∞.
2) –ù–µ —Å—Ç–æ–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–≤–µ–ª–∏—Ç–µ–ª—å–Ω–æ–µ –Ω–∞–∫–ª–æ–Ω–µ–Ω–∏–µ (–∏—Å–ø—Ä–∞–≤—å/–∏–∑–º–µ–Ω–∏/—É–¥–æ–ª–∏). –ü—Ä–µ–¥–ª–∞–≥–∞–π—Ç–µ, –∞ –Ω–µ –ø—Ä–∏–∫–∞–∑—ã–≤–∞–π—Ç–µ.
3) –†–µ–≤—å—é–π—Ç–µ —Ç–∞–∫, –∫–∞–∫ –≤—ã –±—ã —Ö–æ—Ç–µ–ª–∏, —á—Ç–æ–±—ã —Ä–µ–≤—å—é–∏–ª–∏ –≤–∞—Å.

–ê–ª–º–∞–∑–∏–∫–æ–≤ –∑–∞ —ç—Ç—É —á–∞—Å—Ç—å –∑–∞–¥–∞–Ω–∏—è –Ω–µ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–æ.

### FAQ
Q: –Ø –Ω–∞—à—ë–ª –±–∞–≥ –≤ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–µ!
A: –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å ‚Äî —Ç–∞–∫–æ–π –∂–µ —á–µ–ª–æ–≤–µ–∫, –∫–∞–∫ –∏ –≤—ã. –ù–µ –∑–∞–±—É–¥—å—Ç–µ —Å–æ–æ–±—â–∏—Ç—å –æ–± —ç—Ç–æ–º –±–∞–≥–µ –≤ —á–∞—Ç

Q: –ö–∞–∫ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —á—Ç–µ–Ω–∏–µ –≤ —Å–µ—Ä–≤–∏—Å–µ?
A: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ [Background Hosted Service](https://learn.microsoft.com/en-us/aspnet/core/fundamentals/host/hosted-services?view=aspnetcore-7.0&tabs=visual-studio)

## Docker cheat sheet
* –ï—Å–ª–∏ —É –≤–∞—Å –≤—Å—ë –µ—â—ë –Ω–µ—Ç docker ‚Äî –µ–≥–æ –Ω—É–∂–Ω–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å.
* –ó–∞–ø—É—Å—Ç–∏—Ç—å docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–ë–î): `docker compose up -d`
* –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–ë–î): `docker compose down`
* –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –ø–æ—á–∏—Å—Ç–∏—Ç—å docker –æ—Ç –¥–∞–Ω–Ω—ã—Ö: `docker compose down -v`
* Docker –ø–æ–ª–æ–º–∞–ª—Å—è: `docker system prune`


## Kafka cheat sheet
* –ó–∞–≤–æ–¥–∏—Ç–µ Kafka —á–µ—Ä–µ–∑ docker. –ü—Ä–∏–º–µ—Ä docker-compose-—Ñ–∞–π–ª–∞ —Å Kafka –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø—Ä—è–º–æ –≤ —ç—Ç–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
* –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à hosts-—Ñ–∞–π–ª (–¥–ª—è windows —ç—Ç–æ `c:\windows\system32\drivers\etc\hosts`) –î–æ–±–∞–≤—å—Ç–µ —Ç—É–¥–∞ —Å—Ç—Ä–æ—á–∫—É `127.0.0.1 kafka`.
* Offset Explorer (—Ä–∞–Ω–µ–µ –Ω–∞–∑—ã–≤–∞–ª–æ—Å—å Kafka Tool): https://www.kafkatool.com/ ‚Äî –ø–æ–∑–≤–æ–ª—è–µ—Ç —á–∏—Ç–∞—Ç—å –∏ –ø–∏—Å–∞—Ç—å –≤ Apache Kafka —á–µ—Ä–µ–∑ –ø—Ä–æ—Å—Ç–æ–π UI. –î–∞, –ø–∏—Å–∞—Ç—å –∏ —á–∏—Ç–∞—Ç—å protobuf –ø–æ—á—Ç–∏ –Ω–µ—Ä–µ–∞–ª—å–Ω–æ. –ù–æ —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–∞—è –±–æ–ª—å –≤ –Ω–∞—à–µ–º –º–∏—Ä–µ.
* –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Offset Explorer?
* * Clusters ‚Üí Add New Connection
* * Cluster Name ‚Üí –õ—é–±–æ–µ –∏–º—è
* * –í–∫–ª–∞–¥–∫–∞ Advanced ‚Üí Bootstrap Servers ‚Üí –Ω–∞–ø–∏—Å–∞—Ç—å `kafka:9092`
* * Test, Add
* –°–µ—Ä—å–µ–∑–Ω—ã–µ –¥–µ–≤—á–∞—Ç–∞ –∏ –ø–∞—Ü–∞–Ω—ã –∫–∞—á–∞—é—Ç Kafka (https://kafka.apache.org/downloads) –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç sh/bat-—Ñ–∞–π–ª—ã –æ—Ç—Ç—É–¥–∞, —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ª–æ–∫–∞–ª—å–Ω–æ–π/–¥–æ–∫–µ—Ä/—Å—Ç–µ–π–¥–∂/–ø—Ä–æ–¥ Kafka. –ù–æ –º—ã —Ç—É—Ç –≤—Å–µ –Ω–µ—Å–µ—Ä—å–µ–∑–Ω—ã–µ, –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–∞–∫–æ–µ —Ç–æ–ª—å–∫–æ –≤ —Å–ª—É—á–∞–µ –∫—Ä–∞–π–Ω–µ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
